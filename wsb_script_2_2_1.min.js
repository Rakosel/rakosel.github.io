var stopAll=false,ra,rs,subwdeb=false,lines_in,i,url;var maOBJ,seOBJ,bmeOBJ;var str_out="",str_out1="";var uart_json={};var temp_json={};var input_lm75={};var scrPos=0,ovShBtn0=false;var ast=0;var ua_mode=0;var tmranim=3000;var sds,mds,sets;sds=$('.sideset');mds=$('.macnt');sets=$('.setcnt');cnftmp=$('.scntf');function btn_otp_wr() {var url1='/otp_mode?input='+encodeURIComponent("Wr345")+'&';fetch(url1,'GET',txjstmp,20);} function btn_sensor_rd() {var sval=$("#btnsens_val").val();var url1;var i=0;if(ast==1) {return;} for(i=0;i<sval;i++) {url1='/otp_mode?input='+encodeURIComponent("GiveMeas")+'&';fetch(url1,'GET',txjstmp,40);}} function btn_otp_rd() {var url1='/otp_mode?input='+encodeURIComponent("Rd345")+'&';fetch(url1,'GET',txjstmp,20);} function refr_rtc() {if((subwdeb==false)&&$("#autmp").prop("checked")) {fetch('/get_rtc.json?n='+Math.random(),'GET',txjstmp,10);sub_grad();}} function btn_rtc_wr() {var rtc_setd={"rtc_set":[Math.floor(Date.now()/1000),0,0]};fetch('/set_rtc.json?n='+encodeURIComponent(JSON.stringify(rtc_setd))+'&','GET',txjstmp,10);} function btn_htu21d_Wr() {var heater=$("#htu21d_ht option:selected").val();var mode=$("#htu21d_m option:selected").val();$(".btns_htu21d").removeClass('badge-success');$(".btns_htu21d").removeClass('badge-danger');var input_htu21d={"htu21d_conf":[mode,heater]};fetch('/input_htu21d.json?n='+encodeURIComponent(JSON.stringify(input_htu21d))+'&','GET',txjstmp,10);} function btn_htu21d_Rd() {$(".btns_htu21d").removeClass('badge-success');$(".btns_htu21d").removeClass('badge-danger');fetch('/output_htu21d.json?n='+Math.random(),'GET',txjstmp,10);} function btn_sht30_1_Wr() {var heater=$("#sht30_ht option:selected").val();var mode=$("#sht30_m option:selected").val();var scr=$("#sht30_scr option:selected").val();var rep=$("#sht30_rep option:selected").val();var mps_sel=$("#sht30_mps_sel option:selected").val();$(".btns_sht30").removeClass('badge-success');$(".btns_sht30").removeClass('badge-danger');input_sht30={"sht30_conf":[heater,mode,scr,rep,mps_sel]};fetch('/input_sht30_1.json?n='+encodeURIComponent(JSON.stringify(input_sht30))+'&','GET',txjstmp,10);} function btn_sht30_2_Wr() {var heater=$("#sht31_ht option:selected").val();var mode=$("#sht31_m option:selected").val();var scr=$("#sht31_scr option:selected").val();var rep=$("#sht31_rep option:selected").val();var mps_sel=$("#sht31_mps_sel option:selected").val();$(".btns_sht31").removeClass('badge-success');$(".btns_sht31").removeClass('badge-danger');input_sht31={"sht31_conf":[heater,mode,scr,rep,mps_sel]};fetch('/input_sht30_2.json?n='+encodeURIComponent(JSON.stringify(input_sht31))+'&','GET',txjstmp,10);} function btn_sht30_1_Rd() {$(".btns_sht30_1").removeClass('badge-success');$(".btns_sht30_1").removeClass('badge-danger');fetch('/output_sht30_1.json?n='+Math.random(),'GET',txjstmp,10);} function btn_sht30_2_Rd() {$(".btns_sht31").removeClass('badge-success');$(".btns_sht31").removeClass('badge-danger');fetch('/output_sht30_2.json?n='+Math.random(),'GET',txjstmp,10);} function btn_bm280_1_Wr() {var mode=$("#bm1s_m option:selected").val();var osrs=$("#bm1s_osrs option:selected").val();var bm1s_f=$("#bm1s_f option:selected").val();var bm1_t_st=$("#bm1_t_st option:selected").val();var bm_alt=$("#bm_alt").val();$(".btns_bme280_1").removeClass('badge-success');$(".btns_bme280_1").removeClass('badge-danger');if($.isNumeric(bm_alt)==false) {$(".btns_bme280_1").addClass('badge-danger').text("Ошибка (смотри выше)");return;} input_bme280={"bme280_conf":[mode,osrs,bm1s_f,bm1_t_st,bm_alt]};fetch('/input_bme280_1.json?n='+encodeURIComponent(JSON.stringify(input_bme280))+'&','GET',txjstmp,10);} function btn_bm280_2_Wr() {var mode=$("#bm2s_m option:selected").val();var osrs=$("#bm2s_osrs option:selected").val();var bm1s_f=$("#bm2s_f option:selected").val();var bm1_t_st=$("#bm2_t_st option:selected").val();var bm_alt=$("#bm_alt").val();$(".btns_bme280_2").removeClass('badge-success');$(".btns_bme280_2").removeClass('badge-danger');if($.isNumeric(bm_alt)==false) {$(".btns_bme280_2").addClass('badge-danger').text("Ошибка (смотри выше)");return;} input_bme280={"bme280_conf":[mode,osrs,bm1s_f,bm1_t_st,bm_alt]};fetch('/input_bme280_2.json?n='+encodeURIComponent(JSON.stringify(input_bme280))+'&','GET',txjstmp,10);} function btn_bm280_1_Rd() {$(".btns_bme280_1").removeClass('badge-success');$(".btns_bme280_1").removeClass('badge-danger');fetch('/output_bme280_1.json?n='+Math.random(),'GET',txjstmp,10);} function btn_bm280_2_Rd() {$(".btns_bme280_2").removeClass('badge-success');$(".btns_bme280_2").removeClass('badge-danger');fetch('/output_bme280_2.json?n='+Math.random(),'GET',txjstmp,10);} function txjstmp(s,d){var as1=$('.pst1');var as0=$('.pst0');if(s!=200){as0.removeClass('badge-success');as0.addClass('badge-danger');as0.text("Нет связи");as1.removeClass('badge-success');as1.addClass('badge-danger');as1.text("Нет связи");$('.swdeb').removeAttr('disabled');ftmpd();return 0;}else{as1.removeClass('badge-danger');as0.removeClass('badge-danger');as0.addClass('badge-success');as0.text("ОК ");if(typeof d==='string'){try {temp_json=JSON.parse(d);catch(e) {ftvall("");} else {} if(temp_json["LM75_CMP"]) {var aou1=parseInt(temp_json.LM75_CMP[0],10);var aou2=parseInt(temp_json.LM75_CMP[1],10);if(aou1==1) {$("#lm75_t1_chk").prop('checked',true);} else {$("#lm75_t1_chk").prop('checked',false);} if(aou2==1) {$("#lm75_t2_chk").prop('checked',true);} else {$("#lm75_t2_chk").prop('checked',false);}} if(temp_json["lm_75_1_cb"]) {if(temp_json.lm_75_1_cb=="OK") {$(".btns_lm75_1").addClass('badge-success').text("ОК ");} else {$(".btns_lm75_1").addClass('badge-danger').text("Ошибка ");}} if(temp_json["lm75_1_ou"]) {if(parseInt(temp_json.lm75_1_ou[1],10)!=999||parseInt(temp_json.lm75_1_ou[0],10)!=999) {var aou1=parseInt(temp_json.lm75_1_ou[1],10);var aou2=parseInt(temp_json.lm75_1_ou[2],10);$('.lm75thy_1').text(aou1+" °C");$('.lm75tos_1').text(aou2+" °C");$("#lm75sc_1").val(aou1);$("#lm75so_1").val(aou2);var statlm=parseInt(temp_json.lm75_1_ou[0],10);var i=0;if($.isNumeric(statlm)) {for(i=0;i<=4;i++) {if(statlm&(0x01<<i)) {$("#gLM75ch"+i.toString()).prop('checked',true);} else {$("#gLM75ch"+i.toString()).prop('checked',false);}}} $(".btns_lm75_1").addClass('badge-success').text("ОК ");} else {$(".btns_lm75_1").addClass('badge-danger').text("Ошибка ");}} if(temp_json["lm75_2_ou"]) {if(parseInt(temp_json.lm75_2_ou[1],10)!=999||parseInt(temp_json.lm75_2_ou[0],10)!=999) {var aou1=parseInt(temp_json.lm75_2_ou[1],10);var aou2=parseInt(temp_json.lm75_2_ou[2],10);$('.lm75thy_2').text(aou1+"°C");$('.lm75tos_2').text(aou2+"°C");$("#lm75sc_2").val(aou1);$("#lm75so_2").val(aou2);var statlm=parseInt(temp_json.lm75_2_ou[0],10);var i=0;if($.isNumeric(statlm)) {for(i=0;i<=4;i++) {if(statlm&(0x01<<i)) {$("#gLM752ch"+i.toString()).prop('checked',true);} else {$("#gLM752ch"+i.toString()).prop('checked',false);}}} $(".btns_lm75_2").addClass('badge-success').text("ОК ");} else {$(".btns_lm75_2").addClass('badge-danger').text("Ошибка ");}} if(temp_json["lm_75_2_cb"]) {if(temp_json.lm_75_2_cb=="OK") {$(".btns_lm75_2").addClass('badge-success').text("ОК ");} else {$(".btns_lm75_2").addClass('badge-danger').text("Ошибка ");}} if(temp_json["bme280_1_cb"]) {if(temp_json.bme280_1_cb=="OK") {$(".btns_bme280_1").addClass('badge-success').text("ОК ");} else {$(".btns_bme280_1").addClass('badge-danger').text("Ошибка ");}} if(temp_json["bme280_2_cb"]) {if(temp_json.bme280_2_cb=="OK") {$(".btns_bme280_2").addClass('badge-success').text("ОК ");} else {$(".btns_bme280_2").addClass('badge-danger').text("Ошибка ");}} if(temp_json["GiveMeas_cb"]) {ast=0;if(temp_json.GiveMeas_cb=="#ERR") {ast=1;str_out1="";return;} if(temp_json.GiveMeas_cb=="#OVF") {ast=1;$("#esp_urx").val(str_out1+"#OVF");str_out1="";return;} str_out1=$("#esp_urx").val().toString()+temp_json.GiveMeas_cb+"\n";$("#esp_urx").val(str_out1);} if(temp_json["Wr345_cb"]) {if(temp_json.Wr345_cb=="OK") {$(".btns_otp").removeClass('badge-danger');$(".btns_otp").addClass('badge-success').text("ОК ");} else {$(".btns_otp").removeClass('badge-success');$(".btns_otp").addClass('badge-danger').text("Ошибка Wr345");}} if(temp_json["Rd345_cb"]) {if(temp_json.Rd345_cb=="OK") {$(".btns_otp").removeClass('badge-danger');$(".btns_otp").addClass('badge-success').text("ОК ");} else {$(".btns_otp").removeClass('badge-success');$(".btns_otp").addClass('badge-danger').text("Ошибка Rd345");}} if(temp_json["htu21d_cb"]) {if(temp_json.htu21d_cb=="OK") {$(".btns_htu21d").addClass('badge-success').text("ОК ");} else {$(".btns_htu21d").addClass('badge-danger').text("Ошибка ");}} if(temp_json["htu21d_conf"]) {if(parseInt(temp_json.htu21d_conf[0],10)!=999) {$("#htu21d_st").val("0x"+Number(temp_json.htu21d_conf[0]).toString(16).toUpperCase());var sthtu21d=parseInt(temp_json.htu21d_conf[0],10);$('#htu21d_m option').removeProp("selected");$('#htu21d_ht option').removeProp("selected");$("#htu21d_m [value="+temp_json.htu21d_conf[0]+"]").prop("selected","selected");$("#htu21d_ht [value="+temp_json.htu21d_conf[1]+"]").prop("selected","selected");$(".btns_htu21d").addClass('badge-success').text("ОК ");} else {$(".btns_htu21d").addClass('badge-danger').text("Ошибка ");}} if(temp_json["sht30_1_cb"]) {if(temp_json.sht30_1_cb=="OK") {$(".btns_sht30").addClass('badge-success').text("ОК ");} else {$(".btns_sht30").addClass('badge-danger').text("Ошибка ");}} if(temp_json["sht30_2_cb"]) {if(temp_json.sht30_2_cb=="OK") {$(".btns_sht31").addClass('badge-success').text("ОК ");} else {$(".btns_sht31").addClass('badge-danger').text("Ошибка ");}} if(temp_json["sht30_1_ou"]) {if(parseInt(temp_json.sht30_1_ou[0],10)!=999) {$("#sht30_st").val("0x"+Number(temp_json.sht30_1_ou[0]).toString(16).toUpperCase());var stsht30=parseInt(temp_json.sht30_1_ou[0],10);$('#sht30_ht option').removeProp("selected");$('#sht30_m option').removeProp("selected");$('#sht30_scr option').removeProp("selected");$('#sht30_rep option').removeProp("selected");$('#sht30_mps_sel option').removeProp("selected");$("#sht30_ht [value="+temp_json.sht30_1_ou[1]+"]").prop("selected","selected");$("#sht30_m [value="+temp_json.sht30_1_ou[2]+"]").prop("selected","selected");$("#sht30_rep [value="+temp_json.sht30_1_ou[3]+"]").prop("selected","selected");$("#sht30_mps_sel [value="+temp_json.sht30_1_ou[4]+"]").prop("selected","selected");$("#sht30_scr [value="+temp_json.sht30_1_ou[5]+"]").prop("selected","selected");$("#sht30_m").click();$(".btns_sht30").addClass('badge-success').text("ОК ");} else {$(".btns_sht30").addClass('badge-danger').text("Ошибка ");}} if(temp_json["sht30_2_ou"]) {if(parseInt(temp_json.sht30_2_ou[0],10)!=999) {$("#sht31_st").val("0x"+Number(temp_json.sht30_2_ou[0]).toString(16).toUpperCase());var stsht30=parseInt(temp_json.sht30_2_ou[0],10);$('#sht31_ht option').removeProp("selected");$('#sht31_m option').removeProp("selected");$('#sht31_scr option').removeProp("selected");$('#sht31_rep option').removeProp("selected");$('#sht31_mps_sel option').removeProp("selected");$("#sht31_ht [value="+temp_json.sht30_2_ou[1]+"]").prop("selected","selected");$("#sht31_m [value="+temp_json.sht30_2_ou[2]+"]").prop("selected","selected");$("#sht31_rep [value="+temp_json.sht30_2_ou[3]+"]").prop("selected","selected");$("#sht31_mps_sel [value="+temp_json.sht30_2_ou[4]+"]").prop("selected","selected");$("#sht31_scr [value="+temp_json.sht30_2_ou[5]+"]").prop("selected","selected");$("#sht31_m").click();$(".btns_sht31").addClass('badge-success').text("ОК ");} else {$(".btns_sht31").addClass('badge-danger').text("Ошибка ");}} if(temp_json["bme280_1_ou"]) {if(parseInt(temp_json.bme280_1_ou[1],10)!=999||parseInt(temp_json.bme280_1_ou[0],10)!=999) {$("#bm1_ch").val("0x"+Number(temp_json.bme280_1_ou[0]).toString(16).toUpperCase());var bmst1=parseInt(temp_json.bme280_1_ou[1],10);$("#bm1_st").val("0x"+Number(temp_json.bme280_1_ou[1]).toString(16).toUpperCase());if($.isNumeric(bmst1)) {if(bmst1&0x01) {$("#gBM2801ch0").prop('checked',true);else {$("#gBM2801ch0").prop('checked',false);if(bmst1&0x08) {$("#gBM2801ch3").prop('checked',true);else {$("#gBM2801ch3").prop('checked',false);$('#bm1s_m option').removeProp("selected");$('#bm1s_osrs option').removeProp("selected");$('#bm1s_f option').removeProp("selected");$('#bm1_t_st option').removeProp("selected");$("#bm1s_m [value="+temp_json.bme280_1_ou[2]+"]").prop("selected","selected");$("#bm1s_osrs [value="+temp_json.bme280_1_ou[3]+"]").prop("selected","selected");$("#bm1s_f [value="+temp_json.bme280_1_ou[4]+"]").prop("selected","selected");$("#bm1_t_st [value="+temp_json.bme280_1_ou[5]+"]").prop("selected","selected");$(".btns_bme280_1").addClass('badge-success').text("ОК ");}} else {$("#bm1_ch").val("Ошибка");$("#bm1_st").val("Ошибка");$(".btns_bme280_1").addClass('badge-danger').text("Ошибка ");}} if(temp_json["bme280_2_ou"]) {if(parseInt(temp_json.bme280_2_ou[1],10)!=999||parseInt(temp_json.bme280_2_ou[0],10)!=999) {$("#bm2_ch").val("0x"+Number(temp_json.bme280_2_ou[0]).toString(16).toUpperCase());var bmst2=parseInt(temp_json.bme280_2_ou[1],10);$("#bm2_st").val("0x"+Number(temp_json.bme280_2_ou[1]).toString(16).toUpperCase());if($.isNumeric(bmst2)) {if(bmst2&0x01) {$("#gBM2802ch0").prop('checked',true);else {$("#gBM2802ch0").prop('checked',false);if(bmst1&0x08) {$("#gBM2802ch3").prop('checked',true);else {$("#gBM2802ch3").prop('checked',false);$('#bm2s_m option').removeProp("selected");$('#bm2s_osrs option').removeProp("selected");$('#bm2s_f option').removeProp("selected");$('#bm2_t_st option').removeProp("selected");$("#bm2s_m [value="+temp_json.bme280_2_ou[2]+"]").prop("selected","selected");$("#bm2s_osrs [value="+temp_json.bme280_2_ou[3]+"]").prop("selected","selected");$("#bm2s_f [value="+temp_json.bme280_2_ou[4]+"]").prop("selected","selected");$("#bm2_t_st [value="+temp_json.bme280_2_ou[5]+"]").prop("selected","selected");$(".btns_bme280_2").addClass('badge-success').text("ОК ");}} else {$("#bm2_ch").val("Ошибка");$("#bm2_st").val("Ошибка");$(".btns_bme280_2").addClass('badge-danger').text("Ошибка ");}} if(temp_json["temp"]) {for(i=3;i<maOBJ.length;i++) {try {if((temp_json.temp[i-3]=="#ERR")||(temp_json.temp[i-3]=='')) {tmpvlof(i);} else {tmpvlon(i);} if((i-3)<=temp_json.temp.length) {$("#"+maOBJ[i].name).val(temp_json.temp[i-3]);} if(temp_json["temt_adc"]) {$("#tm_adc").val(temp_json.temt_adc);}} catch(e) {tmpvlof(i);} var tht=parseFloat($("#htu21_t").val());var thh=parseFloat($("#htu21_h").val());var PP=(1.359*Math.pow(10,8)*Math.pow(10,(-1762.39/(tht+235.66))));var PPp=((PP*133.32)/1000).toString();$("#htu21_pp").val(PPp.substring(0,5));var DEW=(-(1762.39/(Math.log(thh*(PP*0.01))-8.1332)+235.66)).toString();$("#htu21_dew").val(DEW.substring(0,5));} if(temp_json["debug"]) {if(temp_json.debug=="ON") {sdmc_sh();as1.removeClass('badge-warning');as1.addClass('badge-success');as1.text("ВКЛ");} else if(temp_json.debug=="OFF") {sdmc_rm();as1.removeClass('badge-success');as1.addClass('badge-warning');as1.text("ВЫКЛ");} else {as1.removeClass('badge-success');as1.addClass('badge-danger');as1.text("НЕТ СВЯЗИ");} $('.swdeb').removeAttr('disabled');} if(temp_json["rtc_get"]) {i=0;for(i in temp_json.rtc_get) {str_out+=temp_json.rtc_get[i]+'-'} $(".ptime").text(str_out.substring(0,str_out.length-1));} str_out="";} function tmpvlon(ii) {$("#"+maOBJ[ii].name).removeClass('is-invalid').html();$("#"+maOBJ[ii].name).removeClass('is-valid').html();$("#"+maOBJ[ii].name).addClass('is-valid').html();} function tmpvlof(ii) {$("#"+maOBJ[ii].name).removeClass('is-invalid').html();$("#"+maOBJ[ii].name).removeClass('is-valid').html();$("#"+maOBJ[ii].name).addClass('is-invalid').html();} function sdmc_sh() {mds.removeClass('collapse show');mds.addClass('collapse hide');sds.removeClass('collapse hide');sds.addClass('collapse show');sets.removeClass('collapse hide');sets.addClass('collapse show');} function sdmc_rm() {mds.removeClass('collapse hide');mds.addClass('collapse show');sds.removeClass('collapse show');sds.addClass('collapse hide');sets.removeClass('collapse show');sets.addClass('collapse hide');} function ftvall(cl) {for(i=0;i<maOBJ.length;i++) {$("#"+maOBJ[i].name).val(cl);$("#"+maOBJ[i].name).removeClass('is-invalid').html();$("#"+maOBJ[i].name).removeClass('is-valid').html();}} function ftmpd() {for(i=0;i<maOBJ.length;i++) {$("#"+maOBJ[i].name).removeClass('is-invalid').html();$("#"+maOBJ[i].name).removeClass('is-valid').html();}} function spt0() {var lines=$('#esp_tx').val().replace(/^[\n]+$/g,'').split(/[\n]+/);return lines;} function smgh() {if(!device.mobile()) {$('.bt0st').click();}} $('.bt0st1').click(function bjst1() {$('.bt0st').click();});function erxclr_uart() {$("#esp_tx").val("");};function etxclr_uart() {$("#esp_urx").val("");str_out1="";};$('.bt0st').click(function bjst() {ast=$('.bt0st').attr("value");if(device.mobile()) {if(ast!="on") {$('.bt0st').attr("value","on");rm_b();rms_b();shs_b();} else {$('.bt0st').attr("value","off");rm_b();rms_b();sh_b();}} else {if(ast!="on") {$('.bt0st').attr("value","on");rm_b();sh_b();} else {$('.bt0st').attr("value","off");rm_b();}}});function rm_b() {$('.mc1').removeClass('col-md-8 col-xl-8').html();$('.bsn0').removeClass('col-md-4 col-xl-4').html();$('.mc1').removeClass('noscroll collapse hide');$('.mc1').addClass('col-12').html();} function sh_b() {$('.mc1').remove('col-12').html();$('.mc1').addClass('col-md-8 col-xl-8').html();$('.bsn0').addClass('col-md-4 col-xl-4').html();} function rms_b() {$('.bsn0').removeClass('col-12 overlay').html();$('.mc1').removeClass('noscroll collapse hide');} function shs_b() {$('.bsn0').addClass('col-12 overlay').html();$('.mc1').addClass('noscroll collapse hide').html();} $('.swdeb').click(function swdebfn() {if(this.checked==true) {$('.swdebl').text("Выключить режим настройки");this.setAttribute("disabled","true");sdeb("ON");subwdeb=true;} else {$('.swdebl').text("Включить режим настройки");this.setAttribute("disabled","false");sdeb("OFF");subwdeb=false;}});function sdeb(bl) {var url1='/debug_mode?input='+encodeURIComponent(bl)+'&';fetch(url1,'GET',txjstmp,10);} function clbtn0() {ast=$('.bt0st').attr("value");if(device.mobile()) {if(ast!="on") {shs_b();sh_b();} else {rms_b();rm_b();} $('.bt0st').click();}} $(window).resize(function(){clresf();});function clresf() {ast=$('.bt0st').attr("value");if(device.mobile()) {if(ast=="on") {rms_b();shs_b();} else {rms_b();}} else {if(ast=="on") {rm_b();sh_b();} else {rm_b();}}} function fetch(url,method,callback,time_out){var xhr=new XMLHttpRequest();xhr.onloadend=function() {callback(xhr.status,xhr.responseText);} xhr.ontimeout=function(){callback(-1,null);} xhr.open(method,url,true);xhr.setRequestHeader('Accept','application/json');xhr.timeout=time_out*200;xhr.send();} function btn_lm75_1s() {$(".btns_lm75_1").removeClass('badge-danger');$(".btns_lm75_1").removeClass('badge-success');fetch('/output_lm75_1.json?n='+Math.random(),'GET',txjstmp,10);} function btn_lm75_2s() {$(".btns_lm75_2").removeClass('badge-danger');$(".btns_lm75_2").removeClass('badge-success');fetch('/output_lm75_2.json?n='+Math.random(),'GET',txjstmp,10);} function btn_lm75_1() {var i=0;var input_lm75={};var tarch=0;var tos1=0;var thyst1=0;var sc_1l=$("#lm75sc_1");var so_1l=$("#lm75so_1");for(i=0;(i<5)&&($("#gLM75ch"+i).val()!=undefined);++i) {if($("#gLM75ch"+i).prop("checked")) {tarch|=(1<<i);}} tos1=sc_1l.val();thyst1=so_1l.val();if(thyst1>tos1&&(thyst1<0)&&(tos1<0)) {i=tos1;thyst1=tos1;tos1=thyst1;} else if(thyst1>tos1) {i=thyst1;thyst1=tos1;tos1=i;} if(tos1==thyst1) {if(thyst1<0&&tos1<0) {thyst1--;} else {tos1++;}} sc_1l.val(thyst1);so_1l.val(tos1);$('.lm75thy_1').text(sc_1l.val()+" C°");$('.lm75tos_1').text(so_1l.val()+" C°");thyst1=parseInt(sc_1l.val());tos1=parseInt(so_1l.val());thyst1=thyst1*2;tos1=tos1*2;input_lm75={"lm75_conf":[tarch,thyst1,tos1]};fetch('/input_lm75_1.json?n='+encodeURIComponent(JSON.stringify(input_lm75))+'&','GET',txjstmp,10);} function btn_lm75_2() {var i=0;var input_lm75={};var tarch=0;var tos1=0;var thyst1=0;var sc_1l=$("#lm75sc_2");var so_1l=$("#lm75so_2");for(i=0;(i<5)&&($("#gLM752ch"+i).val()!=undefined);++i) {if($("#gLM752ch"+i).prop("checked")) {tarch|=(1<<i);}} tos1=sc_1l.val();thyst1=so_1l.val();if(thyst1>tos1&&(thyst1<0)&&(tos1<0)) {i=tos1;thyst1=tos1;tos1=thyst1;} else if(thyst1>tos1) {i=thyst1;thyst1=tos1;tos1=i;} if(tos1==thyst1) {if(thyst1<0&&tos1<0) {thyst1--;} else {tos1++;}} sc_1l.val(thyst1);so_1l.val(tos1);$('.lm75thy_2').text(sc_1l.val()+" C°");$('.lm75tos_2').text(so_1l.val()+" C°");thyst1=parseInt(sc_1l.val());tos1=parseInt(so_1l.val());thyst1=thyst1*2;tos1=tos1*2;input_lm75={"lm75_conf":[tarch,thyst1,tos1]};fetch('/input_lm75_2.json?n='+encodeURIComponent(JSON.stringify(input_lm75))+'&','GET',txjstmp,10);} function sub_grad() {maOBJ=$("#tmpo").serializeArray();fetch('/temp_out.json?n='+Math.random(),'GET',txjstmp,10);} function submit_uart() {$("#btn1").prop("disabled",true);lines_in=spt0();url="";uart_json.uart_out="null";if($("#uart_get_ch").prop("checked")) {ua_mode=1;} else {ua_mode=0;} for(i=0;i<lines_in.length;i++) {uart_json.uart_in=lines_in[i];if(ua_mode==1) {fetch('/uart_get?input='+encodeURIComponent(lines_in[i])+'&','GET',txjs_ua,10);} else {fetch('/uart.json?n='+encodeURIComponent(JSON.stringify(uart_json))+'&','GET',txjs_ua,10);}}} function txjs_ua(s,d){seOBJ=$("#scntf").serializeArray();$("#btn1").prop("disabled",false);if(s!=200){str_out1+="Send command error"+'\n';}else{if(typeof d==='string'){try {uart_json=JSON.parse(d);} catch(e) {} else {uart_json.uart_out="null";uart_json.uart_in="null";} if(uart_json.uart_out=="") {str_out1+='ACK'+'\n';} else {str_out1+=uart_json.uart_out+'\n';}} var esp_uart_out_val=$("#esp_urx") if(esp_uart_out_val.val()!="") {esp_uart_out_val.val(esp_uart_out_val.val()+str_out1);} else {esp_uart_out_val.val(str_out1);} str_out1="";} window.onload=function(){$('.bt0st').attr("value","off");$('.navia').addClass('list-group-item list-group-item-action bg-light border');$("#esp_tx").val('wsbuser.prints(node.heap());');$("#esp_urx").val('');rs=setInterval(refr_rtc,2000);i=0;smgh();}
